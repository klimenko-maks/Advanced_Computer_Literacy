---
title: Формулы и вычисления в Excel
date: 2024-01-23T20:30:00.000Z
topic: Excel
description: Формулы и вычисления.
preview: Учимся ипользоват формулы при вычислениях.
img: excel/02-excel-formula/Alecive-Flatwoken-Apps-File-Formula.512.png
placeholder: excel/02-excel-formula/Alecive-Flatwoken-Apps-File-Formula.512-prev.png
alt: Excel - logo pic
linkImg: excel/02-excel-formula/Alecive-Flatwoken-Apps-File-Formula.512.png
linkImgAlt: Excel - logo Image
# videoURL: 'https://www.youtube-nocookie.com/'
canonicalUrl: excel-formula-2/
permalink: /excel-formula-2/
redirectFrom: /posts/2024/01/16/excel-formula-2/
---

::: slot header

# Excel Формулы и типы данных

:::

## Введение

Рассмотрим для примера, форму опроса заполненную ранее через Google Forms.
Вопервых, скачиваем результаты нашего опроса из гугул формы в формате .XLSX (через броузер в результатах формы опроса) . Примерно как проказано на картинке ниже.

<div class="website-diagrams">
  <v-lazy-image
      :src="$withBase('/images/excel/01-excel-intro/01-save-from-browser.png')"
      :src-placeholder="$withBase('/images/excel/01-excel-intro/01-save-from-browser-prev.png')"
      alt="Save as XLSX Post Picture"
  />
</div>

Так как дальнейшие действия мы будет производить именно в Excel. Конечно же можно начать обрабатывать данные через Гугл Таблицы. Но в этом случае часть формул может отличаться.

## Обработка формы опроса

Обратите внимение, что после экспорта в Excel результатов опроса Google Forms в таблице "шапочка" заголовков уже закреплена автоватически. Google Forms уже позаботился и сделалл это за нас. И тем не мение приведем ее к облее опрятному виду. Сделаем шрифт жирным и по желаню зальём цветом, выставим выравнивание текста по центру. Как на рисунке выше.

Если тект не вмещается в ячейки, то можно воспользоваться автоподбором высоты. Для этого подведем курср к номерам строк, станем между номерами строк. И два раза щелкаем левй клавишей мышь. После этого весь заголовки заголовков будет виден.

<div class="website-diagrams">
  <v-lazy-image
      :src="$withBase('/images/excel/02-excel-formula/01-auto-higth.png')"
      :src-placeholder="$withBase('/images/excel/02-excel-formula/01-auto-higth-prev.png')"
      alt="Auto higth"
  />
</div>

Так же можно добится того же результата через Меню Ффрмат. Выберите строку или строки, высоту которых требуется изменить. Перейдите в раздел ``Главная`` > ``Ячейки`` > ``формат``. В разделе ``Размер ячейки`` выберите ``Автоподбор`` высоты строки.

<div class="website-diagrams">
  <v-lazy-image
      :src="$withBase('/images/excel/02-excel-formula/02-auto-higth-alt.png')"
      :src-placeholder="$withBase('/images/excel/02-excel-formula/02-auto-higth-alt-prev.png')"
      alt="Auto higth alt"
  />
</div>

Далее дадим название нашей таблице. Например ``Результаты анкетирования причин прихода в движение``. Для этого добавим строки выше и оформим как уже деали это в [предыдущей теме](http://localhost:8080/Advanced_Computer_Literacy/excel-intro-1/#%D1%88%D0%B0%D0%BF%D0%BA%D0%B0-%D0%B8-%D0%BE%D1%84%D0%BE%D1%80%D0%BC%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5).

### Сортировка данных

Первым этапом в обработке данных, может быть их сортировака. Напоминаю что любое действие производится над выделенно областью данных. Давайе поробуем осортировать нашу такблице по ФИО. Для этого ставим курсов к столбик ФИО.
Переходим в меню ``Данные`` -> ``Сортировка по возрастанию``. При появлении сообщения **"Обнаружены данные вне указанного диапазон"**, выбираем **"автоматически расширить выделенный диапазон"** и нажимаем клавишу ``Сортировка``.

<div class="website-diagrams">
  <v-lazy-image
      :src="$withBase('/images/excel/02-excel-formula/03-sort-order.png')"
      :src-placeholder="$withBase('/images/excel/02-excel-formula/03-sort-order-prev.png')"
      alt="Sort order"
  />
</div>

Можете потринироваться с порядком сортировки - по возрастанию, по убыванию. И отсортировать так же по другим столбцам, например по дате заполнения.

Далее повторяем пройденный материал про [разделению данных на столбцы](http://localhost:8080/Advanced_Computer_Literacy/excel-intro-1/#%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%B0-%D1%81-%D1%82%D0%B5%D0%BA%D1%81%D1%82%D0%BE%D0%BC-%D0%B2-excel). Как уже проходили на первой лекции. Кроме столбика ФИО можете взять к примеру **Структурная единица, Номер, Округ**. В этом примере выбираем только сами данные без шапки, иначе образуется большое количество лишних столбцов.

> Вышеперечисленный объем матариала
> ⏱
> Примерно 15 минут объяснения

### Начальный анализ данных

Поодобная сортировка и разбиенние данных и есть начальный, подготовительный это в анализе данных. Что такое Анализ? Возьмем определение этого слова из словаря.

<div class="custom-block tip">
Анализ - это метод научного исследования путём рассмотрения отдельных сторон, свойств, составных частей чего-нибуть.
</div>

Вот и мы с вами разбиваем весь объем данных на мелкие составляющие, для более подробного их рассмотрения (как под микроскопом).

Мы уже рассматривали резбиение данных на примере ФИО, то есть разбиения текстовых полей. Так же часто возникает необходимость в разбивке числовых полей на отдельные значения.
К примеру 12.06.2000 мы захотим разбить на отдельные столбцы: Число, Месяц, Год. Мы уже делали подобное на [прошлом занятии](http://localhost:8080/Advanced_Computer_Literacy/excel-intro-1/#%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%B0-%D1%81-%D0%B4%D0%B0%D1%82%D0%B0%D0%BC%D0%B8-%D0%B2-excel).
 Давайте повторим это для столбца **Когда Вы пришли в Движение**. Для этого заранее вставим 2 столбика *справо* от **Когда Вы пришли в Движение** и озаглавим их как Месяц, Год. В данном случае для анази день нам не очень важен, а вот месяц важен. Так мы сожем опреденить наиболее продукивный сезон.

<div class="website-diagrams">
  <v-lazy-image
      :src="$withBase('/images/excel/02-excel-formula/04-data-column.png')"
      :src-placeholder="$withBase('/images/excel/02-excel-formula/04-data-column-prev.png')"
      alt="data"
  />
</div>

Разбиение дат на составняе элементы проще всего осуществлять с использованием формул. В нашем примере для того чтобы получить месяц используем соотвествующую функциюю. И распростаним ее на все значения столбика.

```JS
=МЕСЯЦ(K4)
```

Год так же полчаем при помощью соответсвующей функции ГОД. И так же распросраняем формулу а весь диапазон значений в столбике.

```JS
=ГОД(K4)
```
И получим примерно следующее:

<div class="website-diagrams">
  <v-lazy-image
      :src="$withBase('/images/excel/02-excel-formula/05-data-column-func.png')"
      :src-placeholder="$withBase('/images/excel/02-excel-formula/05-data-column-func-prev.png')"
      alt="data function"
  />
</div>

<div class="custom-block warning">
 Обратите внимание, что Excel чувствителен к локализации. Если у вас англоязычная версия Excel то формулы также потребуется вводить на английском. те  Mounth, Year и тд.
</div>

<div class="custom-block danger">
Если в результате выполнения формулы =МЕСЯЦ() вы получить все тоже полное значение даты 12.06.2000, то вам нужно исправить формат ячейки. Как мы уже делали с вами ранее на прошлом занятии <a href="http://localhost:8080/Advanced_Computer_Literacy/excel-intro-1/#%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%B0-%D1%81-%D0%B4%D0%B0%D1%82%D0%B0%D0%BC%D0%B8-%D0%B2-excel">(по ссылке выше)</a>.
</div>

Если с функцией ``=ГОД`` произошла также проблема, то быстрее всего будет скопировать формат с столбца **Месяц** через меню ``Главная`` -> ``Формат по образцу``.

<div class="website-diagrams">
  <v-lazy-image
      :src="$withBase('/images/excel/02-excel-formula/06-copy-format.png')"
      :src-placeholder="$withBase('/images/excel/02-excel-formula/06-copy-format-prev.png')"
      alt="clone format"
  />
</div>

> Вышеперечисленный объем матариала
> ⏱
> Примерно 30 минут объяснения

<div class="custom-block danger">
ДОПОЛНИТЕЛЬНЫЙ МАТЕРИАЛ НЕ ОЗВУЧЕННЫЙ НА ЗАНЯТИИ
</div>

На занятии мы проговаривали, что хорошо бы узнать **Сезон**, в который приходит больше всего людей. Однако это не реализовали и ограничились только выводом месяца прихода и не более того. Вывод сезона так же можно огранизовать добавив дополнительный столбик рядом с месяцем. И воспользовавшись формулой и  использованием функций ``ЕСЛИ`` и ``ИЛИ``.

```JS
=ЕСЛИ(ИЛИ(L4=12; L4=1; L4=2); "Зима"; ЕСЛИ(ИЛИ(L4=3; L4=4; L4=5); "Весна"; ЕСЛИ(ИЛИ(L4=6; L4=7; L4=8); "Лето"; ЕСЛИ(ИЛИ(L4=9; L4=10; L4=11); "Осень"; ""))))
```

Вид формулы довольно устрашающий, однако в сущности ничего сложного в ней.

Алгоритм работы данной формулы:
- Сначала выполняется проверка значения ячейки L4.
- Если значение ячейки равно 12, 1 или 2 (что соответствует зимним месяцам), то результатом будет строка "Зима".
- Если значение ячейки равно 3, 4 или 5 (что соответствует весенним месяцам), то результатом будет строка "Весна".
- Если значение ячейки равно 6, 7 или 8 (что соответствует летним месяцам), то результатом будет строка "Лето".
- Если значение ячейки равно 9, 10 или 11 (что соответствует осенним месяцам), то результатом будет строка "Осень".
- Если значение ячейки не соответствует ни одному из вышеперечисленных условий, то результатом будет пустая строка "".
- Таким образом, формула проверяет номер месяца и возвращает соответствующий сезон, основываясь на заданных условиях.

<div class="website-diagrams">
  <v-lazy-image
      :src="$withBase('/images/excel/02-excel-formula/07-get-season.png')"
      :src-placeholder="$withBase('/images/excel/02-excel-formula/07-get-season-prev.png')"
      alt="get season"
  />
</div>

<div class="custom-block danger">
Конец дополнительного материала
</div>

<script>
import VLazyImage from 'v-lazy-image/v2/v-lazy-image.es.js';

export default {
  components: {
    VLazyImage
  }
}
</script>

<style lang="stylus" scoped>
.website-diagrams
  width: 30.6875rem
  margin: 0 auto
  .v-lazy-image
    filter: blur(0.375rem)
    will-change: filter
    width: 100%
  .v-lazy-image-loaded
    transition: filter 0.7s
    filter: blur(0)
.zoom-image
  width: 30.6875rem
  margin: 0 auto
  .v-lazy-image
    filter: blur(0.375rem)
    will-change: filter
  .v-lazy-image-loaded
    transition: filter 0.7s
    filter: blur(0)
</style>